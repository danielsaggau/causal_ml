---
title: "A Gentle Introduction into Structural Causal Models"
author: 
- Daniel Saggau $\boldsymbol{\cdot}$ `daniel.saggau@campus.lmu.de`
- Department of Statistics, Ludwig Maximilian University Munich, Germany
date: "April 2021"
output: 
  pdf_document: 
    number_sections: yes
    fig_caption: yes
citation_package: --biblatex
fontsize: 12
linestretch: 1.5
abstract: This paper provides a gentle introduction into causal inference, focusing on structural causal models and respective causal graphs. The first section provides introduces probabilities and will focus on clarifying the difference between observations and causal concepts. The second section discusses the hierachy of causation. The third section dicusses causal graphs. 
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

The values of variables are described as functions of exogeneous and endogeneous variables. 
These mechanisms can also be described with directed graphs. 
Typically one requires for the endogenous variables to fulfill causal sufficiency and the corresponding graph to be acyclic.
Also, one requires mechanisms to be independent.
The student should convey and explain the notation on a number of examples and explain the motivation and role of the aforementioned assumptions.

# Introduction 

In causal research, we are interested in the relationship of our variables outside of a fixed time frame. 
We want to capture relationships that hold outside of an available dataset and results are intended to be generalizable to other time periods^[other datasets].
This paper focuses on structural causal models. 
A lot of research ignores the distinction between structural equation models(SEM) and structural causal models (SCM).
Essentially, the SCM builds on the SEM but there are some important differences.
Firstly, the structural equation model specification stems from disciplines like economics and psychology and is inherently a parametric specification. 
The SCM on the other hand is a non-parametric specification.
Secondly, the SCM allows one to create causal graphs.^[Note that we can also create causal graphs with other models like a Bayesian Causal Network Model]

Nevertheless, both models also have a lot in common. 
Structural Causal Models specify the relationship in functional forms, including latent/unobserved variables.
This is very different to working with conditional probabilities. 
There are two popular schools of thought on how to specify causal mechanisms.

There are a number of reasons why people are interested in structural causal models.
We can specify exogenous and endogenous variables in our model specification for a SCM. 
When all our variables are fully specified within our model specification (endogenous variables only) we have a deterministic SCM.

Note that while this is very unreasonable because we assume we can explain all exogenous error terms and further we assume that there are no unobserved variables. 
Henceforth, when applying these models, they are seldom fully deterministic. 



```{tikz,fig.cap="Structural Causal Model" ,fig.align="center", echo =F}
\usetikzlibrary{calc}
\usetikzlibrary{positioning}
\usetikzlibrary{arrows}
\usetikzlibrary{calc}
\usetikzlibrary{positioning}
\usetikzlibrary{arrows}
  \begin{tikzpicture}[
    sharp corners=2pt,
    inner sep=6pt,
    node distance=2cm,
    >=latex]
\tikzstyle{my node}=[draw, shape = circle, minimum height=1cm,minimum width=1cm]
\tikzstyle{latent}=[draw, shape = rectangle, minimum height=1cm,minimum width=1cm]
\node[my node, fill=gray!30] (A){A};
\node[latent,left of=A](UA){$U_A$};
\node[my node, fill=gray!30] at ($(A)!0.5!(A)-(0pt,1.5cm)$) (T) {T};
\node[my node,right = 1 cm of T, fill=gray!30](C){C};
\node[latent,left = 1cm of T](UT){$U_T$};
\node[latent,right = 1cm of A](UC){$U_C$};
\draw[->] (A) -- (T);
\draw[->] (UA) -- (A);
\draw[->] (UT) -- (T);
\draw[->] (UC) -- (C);
\draw[->] (A) -- (C);
\draw[->] (T) -- (C);
\end{tikzpicture}
```


# Common Queries in Causal Models

 |Method          | Action |  Example
|-----------------|---------------------------|------------------------|
| Prediction      | Observation/Co-occurrence | What happened...
| Intervention    | Do-manipulation           | What happens if ...
| Counterfactual  | Hypothetical Realities    | What would have happened if...

Table: Pearl - Hierachy of Causation 

## Prediction 

## Intervention 

This paper focuses on atomic, policy and off-policy intervention. 


```{tikz,fig.cap="Atomic Intervention", fig.align="center", echo =F}
\usetikzlibrary{calc}
\usetikzlibrary{positioning}
\usetikzlibrary{arrows}
  \begin{tikzpicture}[
    sharp corners=2pt,
    inner sep=7pt,
    node distance=3cm,
    >=latex]
\tikzstyle{my node}=[draw, shape = circle, minimum height=1cm,minimum width=1cm]
\tikzstyle{latent}=[draw, shape = rectangle, minimum height=1cm,minimum width=1cm]
\node[my node, fill=gray!30] (A){A};
\node[latent,left =1 cm of A](UA){$U_A$};
\node[my node, fill=gray!30] at ($(A)!0.5!(A)-(0pt,1.5 cm)$) (T) {t};
\node[my node,right = 1 cm of T, fill=gray!30](C){C};
\node[latent,right=1 cm of A](UC){$U_C$};
\draw[->] (UA) -- (A);
\draw[->] (UC) -- (C);
\draw[->] (A) -- (C);
\draw[->] (T) -- (C);
\end{tikzpicture}
```


```{tikz,fig.cap="Policy Intervention",  fig.align= "center", echo =F}
\usetikzlibrary{calc}
\usetikzlibrary{positioning}
\usetikzlibrary{arrows}
  \begin{tikzpicture}[
    sharp corners=2pt,
    inner sep=6pt,
    node distance=2cm,
    >=latex]
\tikzstyle{my node}=[draw, shape = circle, minimum height=1cm,minimum width=1cm]
\tikzstyle{latent}=[draw, shape = rectangle, minimum height=1cm,minimum width=1cm]
\node[my node, fill=gray!30] (A){A};
\node[latent,left of=A](UA){$U_A$};
\node[my node, fill=gray!70] at ($(A)!0.5!(A)-(0pt,1.5cm)$) (T) {$T_\pi$};
\node[my node,right = 1 cm of T, fill=gray!30](C){C};
\node[latent,left = 1cm of T](UT){$U_T$};
\node[latent,right = 1cm of A](UC){$U_C$};
\draw[->] (A) -- (T);
\draw[->] (UA) -- (A);
\draw[->] (UT) -- (T);
\draw[->] (UC) -- (C);
\draw[->] (A) -- (C);
\draw[->] (T) -- (C);
\end{tikzpicture}
```



## Counterfactuals

Process is described as follows:

(a) Abduction: Cast probability $P(u)$ as conditional probability $P(u|\epsilon)$ 
(b) Action: Exchange $(X = x)$ 
(c) Prediction: Compute $(Y = y)$

## Bayesian Models vs. SCM 

Bayesian approach causal models via conditional probabilities.
Meanwhile structural causal models approach causality via functions.
There are some different inherent to these two approaches.
Conditional probabilities are less stable for causal methods (prediction and intervention).

SCM are able to create counterfactuals, hypothetical knowledge. 
CBN are unable to produce counterfactuals because we fail to specify exogenous variables in a probabilistic model.
CBN only specify observable characteristics. 
SCMs on the other hand specify latent factors too and are built on various distributional assumptions.
In a SCM we may specify the counterfactual distribution from which we can draw counterfactual observations.

 |Method         | CBN |  SCM
|----------------|---------------------------|------------------------|
| Prediction     | $\boldsymbol{\cdot}$ Unstable                                                                                        | $\boldsymbol{\cdot}$ Stable                 
|                | $\boldsymbol{\cdot}$ Volatile to parameter changes                                                                   | $\boldsymbol{\cdot}$ More Natural Specification 
|                | $\boldsymbol{\cdot}$ Re-Estimate entire model                                                                        | $\boldsymbol{\cdot}$ Only estimate $\Delta$ CM
|                |                                                                                                                      | 
| Intervention   | $\boldsymbol{\cdot}$ Costly for Non-Markovian Models                                                                 | $\boldsymbol{\cdot}$ Pot. Cyclic Representation
|                | $\boldsymbol{\cdot}$ Unstable(Nature CP)                                                                             | $\boldsymbol{\cdot}$ Stable(Nature Eq.)
|                | $\boldsymbol{\cdot}$ Only generic estimates($\Delta$ CP)                                                             | $\boldsymbol{\cdot}$ Context specific(Invariance of Eq.)
|                |                                                                                                                      | 
|Counterfactuals | $\boldsymbol{\cdot}$ **Impossible**                                                                                  | $\boldsymbol{\cdot}$ Possible
|                | $\boldsymbol{\cdot}$ no information on latent factors($\epsilon$)                                                    | $\boldsymbol{\cdot}$ Inclusion of latent factors
